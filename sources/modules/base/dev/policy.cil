(sid devnull)

(block dev
	(typeattribute obj_type_attribute)
	(typeattribute storage_obj_type_attribute)

	(typeattribute unconfined_subj_type_attribute)

	(call sys_obj_type (obj_type_attribute))
	(call fs.associate_devtmpfs (obj_type_attribute))

	(typeattribute read_memory_subj_type_attribute)
	(typeattribute not_read_memory_subj_type_or_unconfined_subj_type_attribute)

	(typeattributeset not_read_memory_subj_type_or_unconfined_subj_type_attribute
		(not (read_memory_subj_type_attribute unconfined_subj_type_attribute)))

	(neverallow not_read_memory_subj_type_or_unconfined_subj_type_attribute
		memory.dev (chr_file (read)))

	(typeattribute write_memory_subj_type_attribute)
	(typeattribute not_write_memory_subj_type_or_unconfined_subj_type_attribute)

	(typeattributeset not_write_memory_subj_type_or_unconfined_subj_type_attribute
		(not (write_memory_subj_type_attribute unconfined_subj_type_attribute)))

	(neverallow not_write_memory_subj_type_or_unconfined_subj_type_attribute
		memory.dev (chr_file (append write)))

	(allow unconfined_subj_type_attribute self (capability (sys_rawio)))

	(typeattribute except_storage_obj_type_attribute)

	(typeattributeset except_storage_obj_type_attribute (and (obj_type_attribute) (not (storage_obj_type_attribute))))

	(allow unconfined_subj_type_attribute except_storage_obj_type_attribute all_chr_file_perms_except_mounton_and_execmod))

(block apm
	(blockinherit dev.obj_blk))

(block autofs_dev
	(blockinherit dev.obj_blk))

(block clock
	(blockinherit dev.obj_blk))

(block cpu
	(blockinherit dev.obj_blk))

(block devtty
	(blockinherit dev.obj_blk)

	(call mls_trusted_obj_type (dev))

	(call fs.associate_tmpfs (dev)))

(block dri
	(blockinherit dev.obj_blk))

(block event
	(blockinherit dev.obj_blk))

(block framebuf
	(blockinherit dev.obj_blk))

(block kmsg_dev
	(blockinherit dev.obj_blk))

(block kvm
	(blockinherit dev.obj_blk)

	(call mls_trusted_obj_type (dev)))

(block loop_control
	(blockinherit dev.obj_blk))

(block lvm_control
	(blockinherit dev.obj_blk))

(block mei_misc
	(blockinherit dev.obj_blk))

(block memory
	(blockinherit dev.obj_blk))

(block mouse
	(blockinherit dev.obj_blk))

(block null
	(blockinherit dev.obj_blk)

	(call mls_trusted_obj_type (dev))

	(call fs.associate_tmpfs (dev)))

(block nvram
	(blockinherit dev.obj_blk))

(block printer
	(blockinherit dev.obj_blk))

(block pm_qos_misc
	(blockinherit dev.obj_blk))

(block ppp
	(blockinherit dev.obj_blk))

(block ptmx
	(blockinherit dev.obj_blk)

	(call mls_trusted_obj_type (dev)))

(block random
	(blockinherit dev.obj_blk)

	(call fs.associate_tmpfs (dev)))

(block sound
	(blockinherit dev.obj_blk))

(block tpm
	(blockinherit dev.obj_blk))

(block tun_tap
	(blockinherit dev.obj_blk))

(block uhid
	(blockinherit dev.obj_blk))

(block urandom
	(blockinherit dev.obj_blk)

	(call fs.associate_tmpfs (dev)))

(block usb
	(blockinherit dev.obj_blk))

(block usbmon
	(blockinherit dev.obj_blk))

(block v4l
	(blockinherit dev.obj_blk))

(block vfio
	(blockinherit dev.obj_blk))

(block vhost
	(blockinherit dev.obj_blk)

	(call mls_trusted_obj_type (dev)))

(block watchdog
	(blockinherit dev.obj_blk))

(block wireless
	(blockinherit dev.obj_blk))

(block xserver_misc
	(blockinherit dev.obj_blk))

(block zero
	(blockinherit dev.obj_blk)

	(call mls_trusted_obj_type (dev))

	(call fs.associate_tmpfs (dev)))
